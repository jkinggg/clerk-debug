{"version":3,"file":"rx-storage-ipc-renderer.js","names":["Subject","getRxStorageRemote","IPC_RENDERER_KEY_PREFIX","getRxStorageIpcRenderer","settings","channelId","key","join","messages$","ipcRenderer","on","_event","message","next","postMessage","send","msg","storage","identifier","statics"],"sources":["../../../../src/plugins/electron/rx-storage-ipc-renderer.ts"],"sourcesContent":["import { Subject } from 'rxjs';\nimport {\n    getRxStorageRemote,\n    RxStorageRemote,\n    RxStorageRemoteSettings,\n    MessageFromRemote\n} from '../storage-remote';\nimport type {\n    RxStorageStatics\n} from '../../types';\nimport {\n    IPC_RENDERER_KEY_PREFIX\n} from './electron-helper';\n\nexport type RxStorageIpcRendererSettings = {\n    /**\n     * Set the same key on both sides\n     * to ensure that messages do not get mixed\n     * up when you use more then one storage.\n     */\n    key: string;\n    statics: RxStorageStatics;\n    ipcRenderer: any;\n};\n\nexport type RxStorageIpcRenderer = RxStorageRemote;\nexport function getRxStorageIpcRenderer(\n    settings: RxStorageIpcRendererSettings\n): RxStorageIpcRenderer {\n    const channelId = [\n        IPC_RENDERER_KEY_PREFIX,\n        settings.key\n    ].join('|');\n\n    const messages$ = new Subject<MessageFromRemote>();\n    settings.ipcRenderer.on(channelId, (_event: any, message: any) => {\n        messages$.next(message);\n    });\n\n\n    settings.ipcRenderer.postMessage(\n        channelId,\n        false\n    );\n\n    const send: RxStorageRemoteSettings['send'] = (msg) => {\n        settings.ipcRenderer.postMessage(\n            channelId,\n            msg\n        );\n    };\n    const storage = getRxStorageRemote({\n        identifier: 'electron-ipc-renderer',\n        statics: settings.statics,\n        messages$,\n        send\n    });\n    return storage;\n}\n"],"mappings":"AAAA,SAASA,OAAO,QAAQ,MAAM;AAC9B,SACIC,kBAAkB,QAIf,mBAAmB;AAI1B,SACIC,uBAAuB,QACpB,mBAAmB;AAc1B,OAAO,SAASC,uBAAuBA,CACnCC,QAAsC,EAClB;EACpB,IAAMC,SAAS,GAAG,CACdH,uBAAuB,EACvBE,QAAQ,CAACE,GAAG,CACf,CAACC,IAAI,CAAC,GAAG,CAAC;EAEX,IAAMC,SAAS,GAAG,IAAIR,OAAO,EAAqB;EAClDI,QAAQ,CAACK,WAAW,CAACC,EAAE,CAACL,SAAS,EAAE,CAACM,MAAW,EAAEC,OAAY,KAAK;IAC9DJ,SAAS,CAACK,IAAI,CAACD,OAAO,CAAC;EAC3B,CAAC,CAAC;EAGFR,QAAQ,CAACK,WAAW,CAACK,WAAW,CAC5BT,SAAS,EACT,KAAK,CACR;EAED,IAAMU,IAAqC,GAAIC,GAAG,IAAK;IACnDZ,QAAQ,CAACK,WAAW,CAACK,WAAW,CAC5BT,SAAS,EACTW,GAAG,CACN;EACL,CAAC;EACD,IAAMC,OAAO,GAAGhB,kBAAkB,CAAC;IAC/BiB,UAAU,EAAE,uBAAuB;IACnCC,OAAO,EAAEf,QAAQ,CAACe,OAAO;IACzBX,SAAS;IACTO;EACJ,CAAC,CAAC;EACF,OAAOE,OAAO;AAClB"}